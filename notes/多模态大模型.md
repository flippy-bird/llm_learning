## 多模态大模型

### 1. 任意分辨率

> [多模态模型如何处理任意分辨率输入——Tiling与Packing技术详解](https://zhuanlan.zhihu.com/p/1907024362932015897)
>
> [多模态大模型任意分辨率输入](https://zhuanlan.zhihu.com/p/1936211070889993933)

目前多模态大模型处理多分辨率主要有两种方案：

- Tiling
- Packing

#### Tiling

核心思路是预设一个默认分辨率，称之为tile，随后将图片切分成子图，每个子图的shape与tile一致，再在batch维度做拼接。tiling还会将原图也resize到tile的shape，和子图拼接在一起，以保留全局信息。该方法用一种相对暴力的方式，以fixed shape的ViT实现了动态分辨率的推理。

<img src="https://raw.githubusercontent.com/nashpan/image-hosting/main/image-20250903101230266.png" alt="image-20250903101230266" style="zoom:80%;" />

#### Packing

<img src="https://raw.githubusercontent.com/nashpan/image-hosting/main/1.jpg" style="zoom: 33%;" /> <img src="https://raw.githubusercontent.com/nashpan/image-hosting/main/2.jpg" style="zoom: 50%;"/>

Packing 的思想是直接将不同分辨率的图片 contact在一起，然后做attention的计算，当然，图片与图片之间不能产生联系，因此需要阻隔一下，这里的处理即为上图中的block-diagonal attention mask,这个和transformer中的mask思路是一样的，大致效果如下:

<img src="https://raw.githubusercontent.com/nashpan/image-hosting/main/image-20250903103222064.png" alt="image-20250903103222064"  />

Qwen2.5-Vl使用的就是这种技术

